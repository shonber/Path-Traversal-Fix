<!DOCTYPE html>
<html>
<?php 
	include("../header.php");
?>

<div class="container">
	<br>
	<div class="row " >
		<div class="span3"></div>
		<div id="login" class="span6 well" style='background :white; border:1px silver solid;'>
			<h4>This is just a test</h4>
				<pre><?php
				
				function errorHandler(){
					echo "";
					header("Location: stage1.php");
				}
				
				set_error_handler("errorHandler");
				
					if(isset($_GET["file"]))
					{
						//include($_GET["file"]);
						
						if (strpos($_GET["file"],"../") !== false){
							header("Location: stage1.php");
						}else{
							try{
								include($_GET["file"]);
							}
							catch (Exception $e){
								echo $e->getMessage();
							}
						}
					}
				?>
				</pre>
				<hr/>
				<p>
					<b>Rules: </b><kbd>LFI: try to read xampp/passwords.txt file</kbd>
				</p>
			</form>
		</div>
	</div>
</div>
<script>
	var url = new URL(window.location.href);
	var url_data = url.searchParams.get("file");
	if (url_data === null)
	{
			window.location="stage1.php?file=test.txt";
	}
</script>
</body>
</html>
